<!doctype html>
<html class="docs-version-0.67" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="search" type="application/opensearchdescription+xml" title="React Native ‰∏≠ÊñáÁΩë" href="/opensearch.xml">
<script src="//snack.expo.dev/embed.js" defer="defer"></script>
<script src="//cdn.wwads.cn/js/makemoney.js" defer="defer"></script><title data-react-helmet="true">Enabling TurboModule on Android ¬∑ React Native ‰∏≠ÊñáÁΩë</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="twitter:image" content="https://reactnative.cn/img/logo-og.png"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="0.67"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-0.67"><meta data-react-helmet="true" property="og:url" content="https://reactnative.cn"><meta data-react-helmet="true" property="og:image" content="img/logo-og.png"><meta data-react-helmet="true" property="og:title" content="Enabling TurboModule on Android ¬∑ React Native ‰∏≠ÊñáÁΩë"><meta data-react-helmet="true" name="description" content="Make sure your application meets all the prerequisites."><meta data-react-helmet="true" property="og:description" content="Make sure your application meets all the prerequisites."><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://reactnative.cn/docs/new-architecture-app-modules-android"><link data-react-helmet="true" rel="alternate" href="https://reactnative.cn/docs/new-architecture-app-modules-android" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://reactnative.cn/docs/new-architecture-app-modules-android" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.cbfb91cb.css">
<link rel="preload" href="/assets/js/runtime~main.74683e8c.js" as="script">
<link rel="preload" href="/assets/js/main.5540c489.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_3wvD">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/header_logo.svg" alt="React Native ‰∏≠ÊñáÁΩë" class="themedImage_Ir0T themedImage--light_2_E0"><img src="/img/header_logo.svg" alt="React Native ‰∏≠ÊñáÁΩë" class="themedImage_Ir0T themedImage--dark_2JiM"></div><b class="navbar__title">React Native ‰∏≠ÊñáÁΩë</b></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" href="/docs/getting-started">0.67</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/new-architecture-app-modules-android">Next</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/new-architecture-app-modules-android">0.67</a></li><li><a class="dropdown__link" href="/docs/0.66/getting-started">0.66</a></li><li><a class="dropdown__link" href="/docs/0.65/getting-started">0.65</a></li><li><a class="dropdown__link" href="/docs/0.64/getting-started">0.64</a></li><li><a class="dropdown__link" href="/docs/0.63/getting-started">0.63</a></li><li><a class="dropdown__link" href="/versions">ÊâÄÊúâÁâàÊú¨</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/getting-started">ÊñáÊ°£</a><a class="navbar__item navbar__link" href="/docs/components-and-apis">ÁªÑ‰ª∂</a><a class="navbar__item navbar__link" href="/docs/accessibilityinfo">API</a><a class="navbar__item navbar__link" href="/docs/architecture-overview">Êû∂ÊûÑ</a><a href="//time.geekbang.org/column/intro/100110101?code=FAqHFVRUur%2FgAP-yJQWitk9ieF80imRky3PVsIs%2FX6A%3D" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link hot-link"><span>ÂÆûÊàòËØæ<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_pqex"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="//github.com/reactnativecn/react-native-website/issues" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>ËÆ®ËÆ∫<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_pqex"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="//pushy.reactnative.cn" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link hot-link"><span>ÁÉ≠Êõ¥Êñ∞<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_pqex"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a class="navbar__item navbar__link" href="/about">ÂÖ≥‰∫é</a><a href="//github.com/facebook/react-native" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-github-link" aria-label="GitHub repository"></a><div class="toggle_2wFP toggle_2vag toggleDisabled_1jUP"><div class="toggleTrack_OYnE" role="button" tabindex="-1"><div class="toggleTrackCheck_3aVv"><span class="toggleIcon_1mQT">üåú</span></div><div class="toggleTrackX_oB48"><span class="toggleIcon_1mQT">üåû</span></div><div class="toggleTrackThumb_3qal"></div></div><input type="checkbox" class="toggleScreenReader_bg_d" aria-label="Switch between dark and light mode"></div><div class="searchBox_WYtD"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_3jyA"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_2PbN" type="button"></button><main class="docMainContainer_28SP docMainContainerEnhanced_YA74"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_2rXS"><div class="docItemContainer_1EXp"><article><a href="https://time.geekbang.org/column/intro/100110101?code=FAqHFVRUur%2FgAP-yJQWitk9ieF80imRky3PVsIs%2FX6A%3D" target="_blank" style="display:block;padding:12px;background-color:#eee;color:#666;margin-bottom:15px"><span style="font-weight:bold;color:#05a5d1">Êñ∞Êû∂ÊûÑÂÆûÊàòËØæ</span> <!-- -->ÂÆûÊìç + Âü∫Âª∫ + ÂéüÁêÜÂÖ®Áª¥Â∫¶ÂåÖÊèΩÔºåÊä¢ÂÖàÊéåÊè° React Native Êñ∞Êû∂ÊûÑÁ≤æÈ´ì<!-- --> <span style="border:solid 1px #666;padding:4px 6px;margin-left:8px;vertical-align:middle">Á´ãÂç≥Êü•Áúã &gt;</span></a><div class="markdown"><header><h1>Enabling TurboModule on Android</h1></header><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>This documentation is still <strong>experimental</strong> and details are subject to changes as we iterate. Feel free to share your feedback on the <a href="https://github.com/reactwg/react-native-new-architecture/discussions/8" target="_blank" rel="noopener noreferrer">discussion inside the working group</a> for this page.</p><p>Moreover, it contains several <strong>manual steps</strong>. Please note that this won&#x27;t be representative of the final developer experience once the New Architecture is stable. We&#x27;re working on tools, templates and libraries to help you get started fast on the New Architecture, without having to go through the whole setup.</p></div></div><p>Make sure your application meets all the <a href="/docs/new-architecture-app-intro">prerequisites</a>.</p><h2 class="anchor anchorWithStickyNavbar_23Bc" id="1-enable-ndk-and-the-native-build">1. Enable NDK and the native build<a class="hash-link" href="#1-enable-ndk-and-the-native-build" title="Direct link to heading">‚Äã</a></h2><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>In this iteration of the guide we‚Äôre setting up the project to let you build from source. You might notice an increase in your build time because of this. We‚Äôre looking into what would be the preferred approach here so please feel free to share your feedbacks.</p></div></div><p>The code-gen will output some Java and some C++ code that now we need to build.</p><p>Let‚Äôs edit your <strong>module level</strong> <code>build.gradle</code> to include the <strong>two</strong> <code>externalNativeBuild</code> blocks detailed below inside the <code>android{}</code> block:</p><div class="codeBlockContainer_1ukp language-groovy theme-code-block"><div class="codeBlockContent_3Y8q groovy"><pre tabindex="0" class="prism-code language-groovy codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">android {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    defaultConfig {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        applicationId &quot;com.awesomeproject&quot;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        // ...</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        // Add this block</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        externalNativeBuild {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            ndkBuild {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                arguments &quot;APP_PLATFORM=android-21&quot;,</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                        &quot;APP_STL=c++_shared&quot;,</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                        &quot;NDK_TOOLCHAIN_VERSION=clang&quot;,</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                        &quot;GENERATED_SRC_DIR=$buildDir/generated/source&quot;,</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                        &quot;PROJECT_BUILD_DIR=$buildDir&quot;,</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                        &quot;REACT_ANDROID_DIR=$rootDir/../node_modules/react-native/ReactAndroid&quot;,</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                        &quot;REACT_ANDROID_BUILD_DIR=$rootDir/../node_modules/react-native/ReactAndroid/build&quot;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                cFlags &quot;-Wall&quot;, &quot;-Werror&quot;, &quot;-fexceptions&quot;, &quot;-frtti&quot;, &quot;-DWITH_INSPECTOR=1&quot;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                cppFlags &quot;-std=c++17&quot;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                targets &quot;myapplication_appmodules&quot;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    // Add this block</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    externalNativeBuild {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        ndkBuild {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            path &quot;$projectDir/src/main/jni/Android.mk&quot;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><p>In the same <code>build.gradle</code> file, inside the same <code>android{}</code> let‚Äôs add also the following section:</p><div class="codeBlockContainer_1ukp language-groovy theme-code-block"><div class="codeBlockContent_3Y8q groovy"><pre tabindex="0" class="prism-code language-groovy codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">android {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    // ...</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    def reactAndroidProjectDir = project(&#x27;:ReactAndroid&#x27;).projectDir</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    def packageReactNdkLibs = tasks.register(&quot;packageReactNdkLibs&quot;, Copy) {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        dependsOn(&quot;:ReactAndroid:packageReactNdkLibsForBuck&quot;)</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        dependsOn(&quot;generateCodegenArtifactsFromSchema&quot;)</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        from(&quot;$reactAndroidProjectDir/src/main/jni/prebuilt/lib&quot;)</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        into(&quot;$buildDir/react-ndk/exported&quot;)</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    afterEvaluate {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        preBuild.dependsOn(packageReactNdkLibs)</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        configureNdkBuildDebug.dependsOn(preBuild)</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        configureNdkBuildRelease.dependsOn(preBuild)</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    packagingOptions {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        pickFirst &#x27;**/libhermes.so&#x27;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        pickFirst &#x27;**/libjsc.so&#x27;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><p>Finally, we need to create a Makefile inside the <code>src/main/jni</code> folder called <code>Android.mk</code> with the following content:</p><div class="codeBlockContainer_1ukp language-makefile theme-code-block"><div class="codeBlockContent_3Y8q makefile"><pre tabindex="0" class="prism-code language-makefile codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">THIS_DIR </span><span class="token operator" style="color:#fc929e">:=</span><span class="token plain"> </span><span class="token variable" style="color:#cb4b16">$</span><span class="token punctuation" style="color:#657b83">(</span><span class="token keyword" style="color:#c5a5c5">call</span><span class="token plain"> my-dir</span><span class="token punctuation" style="color:#657b83">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">include</span><span class="token plain"> </span><span class="token variable" style="color:#cb4b16">$</span><span class="token punctuation" style="color:#657b83">(</span><span class="token plain">REACT_ANDROID_DIR</span><span class="token punctuation" style="color:#657b83">)</span><span class="token plain">/Android-prebuilt.mk</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">include</span><span class="token plain"> </span><span class="token variable" style="color:#cb4b16">$</span><span class="token punctuation" style="color:#657b83">(</span><span class="token plain">GENERATED_SRC_DIR</span><span class="token punctuation" style="color:#657b83">)</span><span class="token plain">/codegen/jni/Android.mk</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">include</span><span class="token plain"> </span><span class="token variable" style="color:#cb4b16">$</span><span class="token punctuation" style="color:#657b83">(</span><span class="token plain">CLEAR_VARS</span><span class="token punctuation" style="color:#657b83">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">LOCAL_PATH </span><span class="token operator" style="color:#fc929e">:=</span><span class="token plain"> </span><span class="token variable" style="color:#cb4b16">$</span><span class="token punctuation" style="color:#657b83">(</span><span class="token plain">THIS_DIR</span><span class="token punctuation" style="color:#657b83">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">LOCAL_MODULE </span><span class="token operator" style="color:#fc929e">:=</span><span class="token plain"> myapplication_appmodules</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">LOCAL_C_INCLUDES </span><span class="token operator" style="color:#fc929e">:=</span><span class="token plain"> </span><span class="token variable" style="color:#cb4b16">$</span><span class="token punctuation" style="color:#657b83">(</span><span class="token plain">LOCAL_PATH</span><span class="token punctuation" style="color:#657b83">)</span><span class="token plain"> </span><span class="token variable" style="color:#cb4b16">$</span><span class="token punctuation" style="color:#657b83">(</span><span class="token plain">GENERATED_SRC_DIR</span><span class="token punctuation" style="color:#657b83">)</span><span class="token plain">/codegen/jni</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">LOCAL_SRC_FILES </span><span class="token operator" style="color:#fc929e">:=</span><span class="token plain"> </span><span class="token variable" style="color:#cb4b16">$</span><span class="token punctuation" style="color:#657b83">(</span><span class="token keyword" style="color:#c5a5c5">wildcard</span><span class="token plain"> </span><span class="token variable" style="color:#cb4b16">$</span><span class="token punctuation" style="color:#657b83">(</span><span class="token plain">LOCAL_PATH</span><span class="token punctuation" style="color:#657b83">)</span><span class="token plain">/*.cpp</span><span class="token punctuation" style="color:#657b83">)</span><span class="token plain"> </span><span class="token variable" style="color:#cb4b16">$</span><span class="token punctuation" style="color:#657b83">(</span><span class="token keyword" style="color:#c5a5c5">wildcard</span><span class="token plain"> </span><span class="token variable" style="color:#cb4b16">$</span><span class="token punctuation" style="color:#657b83">(</span><span class="token plain">GENERATED_SRC_DIR</span><span class="token punctuation" style="color:#657b83">)</span><span class="token plain">/codegen/jni/*.cpp</span><span class="token punctuation" style="color:#657b83">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">LOCAL_EXPORT_C_INCLUDES </span><span class="token operator" style="color:#fc929e">:=</span><span class="token plain"> </span><span class="token variable" style="color:#cb4b16">$</span><span class="token punctuation" style="color:#657b83">(</span><span class="token plain">LOCAL_PATH</span><span class="token punctuation" style="color:#657b83">)</span><span class="token plain"> </span><span class="token variable" style="color:#cb4b16">$</span><span class="token punctuation" style="color:#657b83">(</span><span class="token plain">GENERATED_SRC_DIR</span><span class="token punctuation" style="color:#657b83">)</span><span class="token plain">/codegen/jni</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token comment" style="color:#93a1a1"># Please note as one of the library listed is libreact_codegen_samplelibrary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token comment" style="color:#93a1a1"># This name will be generated as libreact_codegen_&lt;library-name&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token comment" style="color:#93a1a1"># where &lt;library-name&gt; is the one you specified in the Gradle configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">LOCAL_SHARED_LIBRARIES </span><span class="token operator" style="color:#fc929e">:=</span><span class="token plain"> libjsi \</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    libfbjni \</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    libglog \</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    libfolly_json \</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    libyoga \</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    libreact_nativemodule_core \</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    libturbomodulejsijni \</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    librrc_view \</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    libreact_render_core \</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    libreact_render_graphics \</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    libfabricjni \</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    libfolly_futures \</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    libreact_debug \</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    libreact_render_componentregistry \</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    libreact_render_debug \</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    libruntimeexecutor \</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    libreact_codegen_rncore \</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    libreact_codegen_samplelibrary</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">LOCAL_CFLAGS </span><span class="token operator" style="color:#fc929e">:=</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    -DLOG_TAG</span><span class="token operator" style="color:#fc929e">=</span><span class="token plain">\&quot;ReactNative\&quot;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">LOCAL_CFLAGS </span><span class="token operator" style="color:#fc929e">+=</span><span class="token plain"> -fexceptions -frtti -std</span><span class="token operator" style="color:#fc929e">=</span><span class="token plain">c++17 -Wall</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">include</span><span class="token plain"> </span><span class="token variable" style="color:#cb4b16">$</span><span class="token punctuation" style="color:#657b83">(</span><span class="token plain">BUILD_SHARED_LIBRARY</span><span class="token punctuation" style="color:#657b83">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><p>This setup will run a native build on your project and will compile the C++ files that have been generated by the codegen. You will see the native build running with the Gradle task <code>:app:externalNativeBuildDebug</code></p><p>You can now verify that everything works correctly by running your android app:</p><div class="codeBlockContainer_1ukp language-bash theme-code-block"><div class="codeBlockContent_3Y8q bash"><pre tabindex="0" class="prism-code language-bash codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token function" style="color:#79b6f2">yarn</span><span class="token plain"> react-native run-android</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_23Bc" id="2-java---provide-a-reactpackageturbomodulemanagerdelegate">2. Java - Provide a <code>ReactPackageTurboModuleManagerDelegate</code><a class="hash-link" href="#2-java---provide-a-reactpackageturbomodulemanagerdelegate" title="Direct link to heading">‚Äã</a></h2><p>Now is time to actually use the TurboModule.
First, we will need to create a <code>ReactPackageTurboModuleManagerDelegate</code> subclass, like the following:</p><div class="codeBlockContainer_1ukp language-java theme-code-block"><div class="codeBlockContent_3Y8q java"><pre tabindex="0" class="prism-code language-java codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">package com.awesomeproject;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">import com.facebook.jni.HybridData;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">import com.facebook.react.ReactPackage;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">import com.facebook.react.ReactPackageTurboModuleManagerDelegate;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">import com.facebook.react.bridge.ReactApplicationContext;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">import com.facebook.soloader.SoLoader;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">import java.util.List;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">public class MyApplicationTurboModuleManagerDelegate extends ReactPackageTurboModuleManagerDelegate {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    private static volatile boolean sIsSoLibraryLoaded;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    protected MyApplicationTurboModuleManagerDelegate(ReactApplicationContext reactApplicationContext, List&lt;ReactPackage&gt; packages) {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        super(reactApplicationContext, packages);</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    protected native HybridData initHybrid();</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    public static class Builder extends ReactPackageTurboModuleManagerDelegate.Builder {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        protected MyApplicationTurboModuleManagerDelegate build(</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                ReactApplicationContext context, List&lt;ReactPackage&gt; packages) {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            return new MyApplicationTurboModuleManagerDelegate(context, packages);</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    protected synchronized void maybeLoadOtherSoLibraries() {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        // Prevents issues with initializer interruptions.</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        if (!sIsSoLibraryLoaded) {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            SoLoader.loadLibrary(&quot;myapplication_appmodules&quot;);</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            sIsSoLibraryLoaded = true;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><p>Please note that the <code>SoLoader.loadLibrary</code> parameter (in this case <code>&quot;myapplication_appmodules&quot;)</code> should be the same as the one specified for <code>LOCAL_MODULE :=</code> inside the <code>Android.mk</code> file you created before.</p><p>This class will then be responsible of loading the TurboModules and will take care of loading the native library build with the NDK at runtime.</p><h2 class="anchor anchorWithStickyNavbar_23Bc" id="3-adapt-your-reactnativehost-to-use-the-reactpackageturbomodulemanagerdelegate">3. Adapt your <code>ReactNativeHost</code> to use the <code>ReactPackageTurboModuleManagerDelegate</code><a class="hash-link" href="#3-adapt-your-reactnativehost-to-use-the-reactpackageturbomodulemanagerdelegate" title="Direct link to heading">‚Äã</a></h2><p>Then, you can provide the class you created to your <code>ReactNativeHost</code>. You can locate your <code>ReactNativeHost</code> by searching for the <code>getReactNativeHost()</code>. The <code>ReactNativeHost</code> is usually located inside your <code>Application</code> class.</p><p>Once you located it, you need to add the <code>getReactPackageTurboModuleManagerDelegateBuilder</code> method as from the snippet below:</p><div class="codeBlockContainer_1ukp language-java theme-code-block"><div class="codeBlockContent_3Y8q java"><pre tabindex="0" class="prism-code language-java codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">public class MyApplication extends Application implements ReactApplication {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    private final ReactNativeHost mReactNativeHost =</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        new ReactNativeHost(this) {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            @Override</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            public boolean getUseDeveloperSupport() { /* ... */ }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            @Override</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            protected List&lt;ReactPackage&gt; getPackages() { /* ... */ }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            @Override</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            protected String getJSMainModuleName() {/* ... */ }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            @NonNull</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            @Override</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            protected ReactPackageTurboModuleManagerDelegate.Builder getReactPackageTurboModuleManagerDelegateBuilder() {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                return new MyApplicationTurboModuleManagerDelegate.Builder();</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_23Bc" id="4-extend-the-getpackages-from-your-reactnativehost-to-use-the-turbomodule">4. Extend the <code>getPackages()</code> from your <code>ReactNativeHost</code> to use the TurboModule<a class="hash-link" href="#4-extend-the-getpackages-from-your-reactnativehost-to-use-the-turbomodule" title="Direct link to heading">‚Äã</a></h2><p>Still on the <code>ReactNativeHost</code> , we need to extend the the <code>getPackages()</code> method to include the newly created TurboModule. Update the method to include the following:</p><div class="codeBlockContainer_1ukp language-java theme-code-block"><div class="codeBlockContent_3Y8q java"><pre tabindex="0" class="prism-code language-java codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">public class MyApplication extends Application implements ReactApplication {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    private final ReactNativeHost mReactNativeHost =</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        new ReactNativeHost(this) {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            @Override</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            public boolean getUseDeveloperSupport() { /* ... */ }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            @Override</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            protected List&lt;ReactPackage&gt; getPackages() {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                List&lt;ReactPackage&gt; packages = new PackageList(this).getPackages();</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                // Add those lines</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                packages.add(new TurboReactPackage() {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                    @Nullable</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                    @Override</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                    public NativeModule getModule(String name, ReactApplicationContext reactContext) {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                        if (name.equals(NativeAwesomeManager.NAME)) {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                            return new NativeAwesomeManager(reactContext);</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                        } else {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                            return null;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                    @Override</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                    public ReactModuleInfoProvider getReactModuleInfoProvider() {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                        return () -&gt; {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                            final Map&lt;String, ReactModuleInfo&gt; moduleInfos = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                            moduleInfos.put(</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                                    NativeAwesomeManager.NAME,</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                                    new ReactModuleInfo(</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                                            NativeAwesomeManager.NAME,</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                                            &quot;NativeAwesomeManager&quot;,</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                                            false, // canOverrideExistingModule</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                                            false, // needsEagerInit</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                                            true, // hasConstants</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                                            false, // isCxxModule</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                                            true // isTurboModule</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                                    )</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                            );</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                            return moduleInfos;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                        };</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                });</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                return packages;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            @Override</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            protected String getJSMainModuleName() {/* ... */ }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            @NonNull</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            @Override</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            protected ReactPackageTurboModuleManagerDelegate.Builder getReactPackageTurboModuleManagerDelegateBuilder() {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">                return new MyApplicationTurboModuleManagerDelegate.Builder();</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        };</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_23Bc" id="5-c-provide-a-native-implementation-for-the-methods-in-your-turbomoduledelegate-class">5. C++ Provide a native implementation for the methods in your <code>*TurboModuleDelegate</code> class<a class="hash-link" href="#5-c-provide-a-native-implementation-for-the-methods-in-your-turbomoduledelegate-class" title="Direct link to heading">‚Äã</a></h2><p>If you take a closer look at the class <code>MyApplicationTurboModuleManagerDelegate</code> that you created before, you will notice how some of the methods are <code>native</code>.</p><p>Therefore, you need to provide some C++ classes to implement those methods. Specifically you will need those files, to be added inside the <code>src/main/jni</code> folder:</p><ul><li><code>MyApplicationTurboModuleManagerDelegate.h</code> An header file for the TurboModule Delegate.</li><li><code>MyApplicationTurboModuleManagerDelegate.cpp</code> The implementation of the aforementioned header file.</li><li><code>MyApplicationModuleProvider.h</code> A header file for the TurboModule provider, where you can specify which TurboModules you want to load.</li><li><code>MyApplicationModuleProvider.cpp</code> The implementation for the aforementioned header file.</li><li><code>OnLoad.cpp</code> Where the initialisation code will be placed. Specifically TurboModule uses FBJNI so the initialisation for such library lives there.</li></ul><p>The content of those files should be the following:</p><h4 class="anchor anchorWithStickyNavbar_23Bc" id="myapplicationturbomodulemanagerdelegateh">MyApplicationTurboModuleManagerDelegate.h<a class="hash-link" href="#myapplicationturbomodulemanagerdelegateh" title="Direct link to heading">‚Äã</a></h4><p>Please note that the <code>kJavaDescriptor</code> should be adapted to follow the package name you picked for your project.</p><div class="codeBlockContainer_1ukp language-cpp theme-code-block"><div class="codeBlockContent_3Y8q cpp"><pre tabindex="0" class="prism-code language-cpp codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token macro property directive-hash" style="color:#2aa198">#</span><span class="token macro property directive keyword" style="color:#c5a5c5">include</span><span class="token macro property" style="color:#2aa198"> </span><span class="token macro property string" style="color:#8dc891">&lt;memory&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#2aa198">#</span><span class="token macro property directive keyword" style="color:#c5a5c5">include</span><span class="token macro property" style="color:#2aa198"> </span><span class="token macro property string" style="color:#8dc891">&lt;string&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#2aa198">#</span><span class="token macro property directive keyword" style="color:#c5a5c5">include</span><span class="token macro property" style="color:#2aa198"> </span><span class="token macro property string" style="color:#8dc891">&lt;ReactCommon/TurboModuleManagerDelegate.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#2aa198">#</span><span class="token macro property directive keyword" style="color:#c5a5c5">include</span><span class="token macro property" style="color:#2aa198"> </span><span class="token macro property string" style="color:#8dc891">&lt;fbjni/fbjni.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">namespace</span><span class="token plain"> facebook </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">namespace</span><span class="token plain"> react </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token plain"> </span><span class="token class-name" style="color:#fac863">MyApplicationTurboModuleManagerDelegate</span><span class="token plain"> </span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token base-clause class-name" style="color:#fac863">public</span><span class="token base-clause"> jni</span><span class="token base-clause operator" style="color:#fc929e">::</span><span class="token base-clause class-name" style="color:#fac863">HybridClass</span><span class="token base-clause operator" style="color:#fc929e">&lt;</span><span class="token base-clause class-name" style="color:#fac863">MyApplicationTurboModuleManagerDelegate</span><span class="token base-clause punctuation" style="color:#657b83">,</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#fac863">TurboModuleManagerDelegate</span><span class="token base-clause operator" style="color:#fc929e">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  </span><span class="token comment" style="color:#93a1a1">// Adapt it to the package you used for your Java class.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">static</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">constexpr</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">auto</span><span class="token plain"> kJavaDescriptor </span><span class="token operator" style="color:#fc929e">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">      </span><span class="token string" style="color:#8dc891">&quot;Lcom/awesomeproject/MyApplicationTurboModuleManagerDelegate;&quot;</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">static</span><span class="token plain"> jni</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">local_ref</span><span class="token operator" style="color:#fc929e">&lt;</span><span class="token plain">jhybriddata</span><span class="token operator" style="color:#fc929e">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">initHybrid</span><span class="token punctuation" style="color:#657b83">(</span><span class="token plain">jni</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">alias_ref</span><span class="token operator" style="color:#fc929e">&lt;</span><span class="token plain">jhybridobject</span><span class="token operator" style="color:#fc929e">&gt;</span><span class="token punctuation" style="color:#657b83">)</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">static</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">void</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">registerNatives</span><span class="token punctuation" style="color:#657b83">(</span><span class="token punctuation" style="color:#657b83">)</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  std</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#fc929e">&lt;</span><span class="token plain">TurboModule</span><span class="token operator" style="color:#fc929e">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">getTurboModule</span><span class="token punctuation" style="color:#657b83">(</span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> std</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">string name</span><span class="token punctuation" style="color:#657b83">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> std</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#fc929e">&lt;</span><span class="token plain">CallInvoker</span><span class="token operator" style="color:#fc929e">&gt;</span><span class="token plain"> jsInvoker</span><span class="token punctuation" style="color:#657b83">)</span><span class="token plain"> override</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  std</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#fc929e">&lt;</span><span class="token plain">TurboModule</span><span class="token operator" style="color:#fc929e">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">getTurboModule</span><span class="token punctuation" style="color:#657b83">(</span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> std</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">string name</span><span class="token punctuation" style="color:#657b83">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> JavaTurboModule</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">InitParams </span><span class="token operator" style="color:#fc929e">&amp;</span><span class="token plain">params</span><span class="token punctuation" style="color:#657b83">)</span><span class="token plain"> override</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">private</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">friend</span><span class="token plain"> HybridBase</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">using</span><span class="token plain"> HybridBase</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">HybridBase</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token punctuation" style="color:#657b83">}</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token punctuation" style="color:#657b83">}</span><span class="token plain"> </span><span class="token comment" style="color:#93a1a1">// namespace react</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token punctuation" style="color:#657b83">}</span><span class="token plain"> </span><span class="token comment" style="color:#93a1a1">// namespace facebook</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_23Bc" id="myapplicationturbomodulemanagerdelegatecpp">MyApplicationTurboModuleManagerDelegate.cpp<a class="hash-link" href="#myapplicationturbomodulemanagerdelegatecpp" title="Direct link to heading">‚Äã</a></h4><div class="codeBlockContainer_1ukp language-cpp theme-code-block"><div class="codeBlockContent_3Y8q cpp"><pre tabindex="0" class="prism-code language-cpp codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token macro property directive-hash" style="color:#2aa198">#</span><span class="token macro property directive keyword" style="color:#c5a5c5">include</span><span class="token macro property" style="color:#2aa198"> </span><span class="token macro property string" style="color:#8dc891">&quot;MyApplicationTurboModuleManagerDelegate.h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#2aa198">#</span><span class="token macro property directive keyword" style="color:#c5a5c5">include</span><span class="token macro property" style="color:#2aa198"> </span><span class="token macro property string" style="color:#8dc891">&quot;MyApplicationModuleProvider.h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">namespace</span><span class="token plain"> facebook </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">namespace</span><span class="token plain"> react </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">jni</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">local_ref</span><span class="token operator" style="color:#fc929e">&lt;</span><span class="token plain">MyApplicationTurboModuleManagerDelegate</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">jhybriddata</span><span class="token operator" style="color:#fc929e">&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:#fac863">MyApplicationTurboModuleManagerDelegate</span><span class="token operator" style="color:#fc929e">::</span><span class="token function" style="color:#79b6f2">initHybrid</span><span class="token punctuation" style="color:#657b83">(</span><span class="token plain">jni</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">alias_ref</span><span class="token operator" style="color:#fc929e">&lt;</span><span class="token plain">jhybridobject</span><span class="token operator" style="color:#fc929e">&gt;</span><span class="token punctuation" style="color:#657b83">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">makeCxxInstance</span><span class="token punctuation" style="color:#657b83">(</span><span class="token punctuation" style="color:#657b83">)</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token punctuation" style="color:#657b83">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">void</span><span class="token plain"> </span><span class="token class-name" style="color:#fac863">MyApplicationTurboModuleManagerDelegate</span><span class="token operator" style="color:#fc929e">::</span><span class="token function" style="color:#79b6f2">registerNatives</span><span class="token punctuation" style="color:#657b83">(</span><span class="token punctuation" style="color:#657b83">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  </span><span class="token function" style="color:#79b6f2">registerHybrid</span><span class="token punctuation" style="color:#657b83">(</span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    </span><span class="token function" style="color:#79b6f2">makeNativeMethod</span><span class="token punctuation" style="color:#657b83">(</span><span class="token string" style="color:#8dc891">&quot;initHybrid&quot;</span><span class="token punctuation" style="color:#657b83">,</span><span class="token plain"> MyApplicationTurboModuleManagerDelegate</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">initHybrid</span><span class="token punctuation" style="color:#657b83">)</span><span class="token punctuation" style="color:#657b83">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  </span><span class="token punctuation" style="color:#657b83">}</span><span class="token punctuation" style="color:#657b83">)</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token punctuation" style="color:#657b83">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">std</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#fc929e">&lt;</span><span class="token plain">TurboModule</span><span class="token operator" style="color:#fc929e">&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:#fac863">MyApplicationTurboModuleManagerDelegate</span><span class="token operator" style="color:#fc929e">::</span><span class="token function" style="color:#79b6f2">getTurboModule</span><span class="token punctuation" style="color:#657b83">(</span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> std</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">string name</span><span class="token punctuation" style="color:#657b83">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> std</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#fc929e">&lt;</span><span class="token plain">CallInvoker</span><span class="token operator" style="color:#fc929e">&gt;</span><span class="token plain"> jsInvoker</span><span class="token punctuation" style="color:#657b83">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  </span><span class="token comment" style="color:#93a1a1">// Not implemented yet: provide pure-C++ NativeModules here.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">nullptr</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token punctuation" style="color:#657b83">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">std</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#fc929e">&lt;</span><span class="token plain">TurboModule</span><span class="token operator" style="color:#fc929e">&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:#fac863">MyApplicationTurboModuleManagerDelegate</span><span class="token operator" style="color:#fc929e">::</span><span class="token function" style="color:#79b6f2">getTurboModule</span><span class="token punctuation" style="color:#657b83">(</span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> std</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">string name</span><span class="token punctuation" style="color:#657b83">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> JavaTurboModule</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">InitParams </span><span class="token operator" style="color:#fc929e">&amp;</span><span class="token plain">params</span><span class="token punctuation" style="color:#657b83">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">MyApplicationModuleProvider</span><span class="token punctuation" style="color:#657b83">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#657b83">,</span><span class="token plain"> params</span><span class="token punctuation" style="color:#657b83">)</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token punctuation" style="color:#657b83">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token punctuation" style="color:#657b83">}</span><span class="token plain"> </span><span class="token comment" style="color:#93a1a1">// namespace react</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token punctuation" style="color:#657b83">}</span><span class="token plain"> </span><span class="token comment" style="color:#93a1a1">// namespace facebook</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_23Bc" id="myapplicationmoduleproviderh">MyApplicationModuleProvider.h<a class="hash-link" href="#myapplicationmoduleproviderh" title="Direct link to heading">‚Äã</a></h4><div class="codeBlockContainer_1ukp language-cpp theme-code-block"><div class="codeBlockContent_3Y8q cpp"><pre tabindex="0" class="prism-code language-cpp codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token macro property directive-hash" style="color:#2aa198">#</span><span class="token macro property directive keyword" style="color:#c5a5c5">pragma</span><span class="token macro property" style="color:#2aa198"> </span><span class="token macro property expression" style="color:#2aa198">once</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#2aa198">#</span><span class="token macro property directive keyword" style="color:#c5a5c5">include</span><span class="token macro property" style="color:#2aa198"> </span><span class="token macro property string" style="color:#8dc891">&lt;memory&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#2aa198">#</span><span class="token macro property directive keyword" style="color:#c5a5c5">include</span><span class="token macro property" style="color:#2aa198"> </span><span class="token macro property string" style="color:#8dc891">&lt;string&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#2aa198">#</span><span class="token macro property directive keyword" style="color:#c5a5c5">include</span><span class="token macro property" style="color:#2aa198"> </span><span class="token macro property string" style="color:#8dc891">&lt;ReactCommon/JavaTurboModule.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">namespace</span><span class="token plain"> facebook </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">namespace</span><span class="token plain"> react </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">std</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#fc929e">&lt;</span><span class="token plain">TurboModule</span><span class="token operator" style="color:#fc929e">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">MyApplicationModuleProvider</span><span class="token punctuation" style="color:#657b83">(</span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> std</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">string moduleName</span><span class="token punctuation" style="color:#657b83">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> JavaTurboModule</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">InitParams </span><span class="token operator" style="color:#fc929e">&amp;</span><span class="token plain">params</span><span class="token punctuation" style="color:#657b83">)</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token punctuation" style="color:#657b83">}</span><span class="token plain"> </span><span class="token comment" style="color:#93a1a1">// namespace react</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token punctuation" style="color:#657b83">}</span><span class="token plain"> </span><span class="token comment" style="color:#93a1a1">// namespace facebook</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_23Bc" id="myapplicationmoduleprovidercpp">MyApplicationModuleProvider.cpp<a class="hash-link" href="#myapplicationmoduleprovidercpp" title="Direct link to heading">‚Äã</a></h4><p>Please adapt the <code>samplelibrary.h</code> import to match the same library name you provided when building the apps.
This is the C++ generated file that is created by the codegen.</p><p>Here you can also specify more than one provider, should you have more than one TurboModule. Specifically in this example we look for a TurboModule from <code>samplelibrary</code> (the one we specified) and we fallback to the <code>rncore</code> Module Provider (containing all the Core modules).</p><div class="codeBlockContainer_1ukp language-cpp theme-code-block"><div class="codeBlockContent_3Y8q cpp"><pre tabindex="0" class="prism-code language-cpp codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token macro property directive-hash" style="color:#2aa198">#</span><span class="token macro property directive keyword" style="color:#c5a5c5">include</span><span class="token macro property" style="color:#2aa198"> </span><span class="token macro property string" style="color:#8dc891">&quot;MyApplicationModuleProvider.h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#2aa198">#</span><span class="token macro property directive keyword" style="color:#c5a5c5">include</span><span class="token macro property" style="color:#2aa198"> </span><span class="token macro property string" style="color:#8dc891">&lt;rncore.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#2aa198">#</span><span class="token macro property directive keyword" style="color:#c5a5c5">include</span><span class="token macro property" style="color:#2aa198"> </span><span class="token macro property string" style="color:#8dc891">&lt;samplelibrary.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">namespace</span><span class="token plain"> facebook </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">namespace</span><span class="token plain"> react </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">std</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#fc929e">&lt;</span><span class="token plain">TurboModule</span><span class="token operator" style="color:#fc929e">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">MyApplicationModuleProvider</span><span class="token punctuation" style="color:#657b83">(</span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> std</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">string moduleName</span><span class="token punctuation" style="color:#657b83">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> JavaTurboModule</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">InitParams </span><span class="token operator" style="color:#fc929e">&amp;</span><span class="token plain">params</span><span class="token punctuation" style="color:#657b83">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">auto</span><span class="token plain"> module </span><span class="token operator" style="color:#fc929e">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">samplelibrary_ModuleProvider</span><span class="token punctuation" style="color:#657b83">(</span><span class="token plain">moduleName</span><span class="token punctuation" style="color:#657b83">,</span><span class="token plain"> params</span><span class="token punctuation" style="color:#657b83">)</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#657b83">(</span><span class="token plain">module </span><span class="token operator" style="color:#fc929e">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">nullptr</span><span class="token punctuation" style="color:#657b83">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">      </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> module</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    </span><span class="token punctuation" style="color:#657b83">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">rncore_ModuleProvider</span><span class="token punctuation" style="color:#657b83">(</span><span class="token plain">moduleName</span><span class="token punctuation" style="color:#657b83">,</span><span class="token plain"> params</span><span class="token punctuation" style="color:#657b83">)</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token punctuation" style="color:#657b83">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token punctuation" style="color:#657b83">}</span><span class="token plain"> </span><span class="token comment" style="color:#93a1a1">// namespace react</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token punctuation" style="color:#657b83">}</span><span class="token plain"> </span><span class="token comment" style="color:#93a1a1">// namespace facebook</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_23Bc" id="onloadcpp">OnLoad.cpp<a class="hash-link" href="#onloadcpp" title="Direct link to heading">‚Äã</a></h4><div class="codeBlockContainer_1ukp language-cpp theme-code-block"><div class="codeBlockContent_3Y8q cpp"><pre tabindex="0" class="prism-code language-cpp codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token macro property directive-hash" style="color:#2aa198">#</span><span class="token macro property directive keyword" style="color:#c5a5c5">include</span><span class="token macro property" style="color:#2aa198"> </span><span class="token macro property string" style="color:#8dc891">&lt;fbjni/fbjni.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#2aa198">#</span><span class="token macro property directive keyword" style="color:#c5a5c5">include</span><span class="token macro property" style="color:#2aa198"> </span><span class="token macro property string" style="color:#8dc891">&quot;MyApplicationTurboModuleManagerDelegate.h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">JNIEXPORT jint JNICALL </span><span class="token function" style="color:#79b6f2">JNI_OnLoad</span><span class="token punctuation" style="color:#657b83">(</span><span class="token plain">JavaVM </span><span class="token operator" style="color:#fc929e">*</span><span class="token plain">vm</span><span class="token punctuation" style="color:#657b83">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">void</span><span class="token plain"> </span><span class="token operator" style="color:#fc929e">*</span><span class="token punctuation" style="color:#657b83">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> facebook</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">jni</span><span class="token operator" style="color:#fc929e">::</span><span class="token function" style="color:#79b6f2">initialize</span><span class="token punctuation" style="color:#657b83">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#657b83">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#657b83">[</span><span class="token punctuation" style="color:#657b83">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    facebook</span><span class="token operator" style="color:#fc929e">::</span><span class="token plain">react</span><span class="token operator" style="color:#fc929e">::</span><span class="token class-name" style="color:#fac863">MyApplicationTurboModuleManagerDelegate</span><span class="token operator" style="color:#fc929e">::</span><span class="token function" style="color:#79b6f2">registerNatives</span><span class="token punctuation" style="color:#657b83">(</span><span class="token punctuation" style="color:#657b83">)</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  </span><span class="token punctuation" style="color:#657b83">}</span><span class="token punctuation" style="color:#657b83">)</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token punctuation" style="color:#657b83">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_23Bc" id="6-enable-the-useturbomodules-flag-in-your-application-oncreate">6. Enable the <code>useTurboModules</code> flag in your Application <code>onCreate</code><a class="hash-link" href="#6-enable-the-useturbomodules-flag-in-your-application-oncreate" title="Direct link to heading">‚Äã</a></h2><p>Now you can finally enable the <code>TurboModule </code>support in your Application. To do so, you need to turn on the <code>useTurboModule</code> flag inside your Application <code>onCreate</code> method.</p><div class="codeBlockContainer_1ukp language-java theme-code-block"><div class="codeBlockContent_3Y8q java"><pre tabindex="0" class="prism-code language-java codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">public class MyApplication extends Application implements ReactApplication {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    public void onCreate() {</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        ReactFeatureFlags.useTurboModules = true;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">        //...</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><p>It‚Äôs now time to run again your Android app to verify that everything works correctly:</p><div class="codeBlockContainer_1ukp language-bash theme-code-block"><div class="codeBlockContent_3Y8q bash"><pre tabindex="0" class="prism-code language-bash codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token function" style="color:#79b6f2">yarn</span><span class="token plain"> react-native run-android</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div></div><footer class="docMetadata row docusaurus-mt-lg"><div class="col"><a href="https://github.com/reactnativecn/react-native-website/blob/production/cnwebsite/../cndocs/new-architecture-app-modules-android.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_1CBY" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_1szQ"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_rbnR thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-enable-ndk-and-the-native-build" class="table-of-contents__link toc-highlight">1. Enable NDK and the native build</a></li><li><a href="#2-java---provide-a-reactpackageturbomodulemanagerdelegate" class="table-of-contents__link toc-highlight">2. Java - Provide a <code>ReactPackageTurboModuleManagerDelegate</code></a></li><li><a href="#3-adapt-your-reactnativehost-to-use-the-reactpackageturbomodulemanagerdelegate" class="table-of-contents__link toc-highlight">3. Adapt your <code>ReactNativeHost</code> to use the <code>ReactPackageTurboModuleManagerDelegate</code></a></li><li><a href="#4-extend-the-getpackages-from-your-reactnativehost-to-use-the-turbomodule" class="table-of-contents__link toc-highlight">4. Extend the <code>getPackages()</code> from your <code>ReactNativeHost</code> to use the TurboModule</a></li><li><a href="#5-c-provide-a-native-implementation-for-the-methods-in-your-turbomoduledelegate-class" class="table-of-contents__link toc-highlight">5. C++ Provide a native implementation for the methods in your <code>*TurboModuleDelegate</code> class</a></li><li><a href="#6-enable-the-useturbomodules-flag-in-your-application-oncreate" class="table-of-contents__link toc-highlight">6. Enable the <code>useTurboModules</code> flag in your Application <code>onCreate</code></a></li></ul><div class="wwads-cn wwads-vertical" data-id="58" style="max-width:200px;margin-top:20px"></div></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">React Native ‰∏≠ÊñáÁΩë ¬© 2022 Ê≠¶Ê±âÈùíÁΩóÁΩëÁªúÁßëÊäÄÊúâÈôêÂÖ¨Âè∏
      <a style="margin-left:10px" href="http://beian.miit.gov.cn/">ÈÑÇICPÂ§á20002031Âè∑-3</a>
      <img style="width:25px" src="//img.alicdn.com/tfs/TB1..50QpXXXXX7XpXXXXXXXXXX-40-40.png" alt="ÈÑÇÂÖ¨ÁΩëÂÆâÂ§á 42011202001821Âè∑">
      <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=42011202001821">ÈÑÇÂÖ¨ÁΩëÂÆâÂ§á 42011202001821Âè∑</a>
      </div></div></div></footer></div>
<script src="/assets/js/runtime~main.74683e8c.js"></script>
<script src="/assets/js/main.5540c489.js"></script>
</body>
</html>